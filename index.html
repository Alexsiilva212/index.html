<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contagem de M√∫sicos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff;
      padding: 10px;
    }

    .centraliza-tudo {
      max-width: 500px;
      margin: 0 auto;
      border: 1px solid #000;
      padding: 0;
    }

    .centraliza-tudo>table,
    .centraliza-tudo>.main-table {
      border: 3px solid #000;
      margin: 1px;
    }

    h2,
    h3 {
      text-align: center;
      margin: 0;
    }

    h3 {
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
    }

    td,
    th {
      border: 1px solid #000;
      padding: 4px;
      text-align: left;
      font-size: 14px;
      white-space: nowrap;
      width: 50px;
    }

    input[type="number"] {
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      text-align: center;
      border: none;
      font-size: 14px;
      background-color: transparent;
    }

    input:focus {
      outline: none;
    }

    .total {
      font-weight: bold;
      background-color: #bcb8b8 !important;
      text-align: left;
      color: #000;
    }

    .total-c {
      font-weight: bold;
      background-color: #bcb8b8 !important;
      text-align: center;
      color: #000;
    }

    .instrumento {
      text-align: center;
    }

    .footer {
      margin-top: 10px;
    }

    textarea {
      width: 100%;
      max-width: 100%;
      height: 60px;
      border: 1px solid #000;
      font-size: 14px;
      resize: none;
      box-sizing: border-box;
    }

    .actions {
      margin-top: 20px;
      text-align: center;
    }

    button {
      padding: 10px 20px;
      font-size: 14px;
      cursor: pointer;
      background: #2c7be5;
      color: #fff;
      border: none;
      border-radius: 4px;
    }

    button:hover {
      background: #1a5cb8;
    }

    .porcentagem-wrapper {
      display: flex;
      align-items: left;
      justify-content: flex-start;
    }

    .percent-simbolo {
      margin-left: 4px;
      font-weight: bold;
      font-size: 14px;
    }

    .porcentagem {
      width: 60px;
      text-align: right;
      border: 1px solid #000;
      border-radius: 4px;
      background-color: #eee;
    }

    @media print {
      button {
        display: none;
      }

      body {
        padding: 0;
        margin: 0;
      }

      table {
        page-break-inside: avoid;
      }

      body,
      table,
      td,
      th {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
      }
    }

    /* Responsividade para celular */
    @media screen and (max-width: 600px) {
      .centraliza-tudo {
        width: 100%;
        border: none;
        padding: 5px;
      }

      table,
      td,
      th {
        font-size: 12px;
        white-space: normal;
      }

      input[type="number"] {
        font-size: 12px;
      }

      button {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <div class="centraliza-tudo">
    <table>
      <tr>
        <td>
          <h2>CONGREGA√á√ÉO CRIST√É NO BRASIL</h2>
          <h3>Vila Nova Curu√ß√° - S√£o Paulo</h3>
          <h3 style="text-align: center;">
            ENSAIO LOCAL - <span id="data"></span>
          </h3>
          <script>
            const data = new Date();
            const opcoes = { day: '2-digit', month: '2-digit', year: 'numeric' };
            const dataFormatada = data.toLocaleDateString('pt-BR', opcoes);
            document.getElementById("data").innerText = dataFormatada;
          </script>
        </td>
      </tr>
    </table>

    <table class="main-table">
      <tr>
        <td>VIOLINOS</td>
        <td><input type="number" class="instrumento cordas" value="0"></td>
        <td>CORNET</td>
        <td><input type="number" class="servico metais" value="0"></td>
      </tr>
      <tr>
        <td>VIOLAS</td>
        <td><input type="number" class="instrumento cordas" value="0"></td>
        <td>FLUEGEHORN</td>
        <td><input type="number" class="servico metais" value="0"></td>
      </tr>
      <tr>
        <td>VIOLONCELOS</td>
        <td><input type="number" class="instrumento cordas" value="0"></td>
        <td>CORNE INGLES</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
      </tr>
      <tr>
        <td>FLAUTAS</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td class="total">TOTAL M√öSICOS</td>
        <td id="totalMusicos" class="total-c">0</td>
      </tr>
      <tr>
        <td>ACORDE√ïES</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>OBO√âS</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>ORGANISTAS</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>CLARINETAS</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>EXAMINADORAS</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>CLARONES</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>ENC. REGIONAIS</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>FAGOTES</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>ENC. LOCAIS</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>SAX-SOPRANO</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>ANCI√ÉES</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>SAX-ALTO</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>DI√ÅCONOS</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>SAX-TENOR</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td>COOPERADORES</td>
        <td><input type="number" class="servico" value="0"></td>
      </tr>
      <tr>
        <td>SAX-BARITONO</td>
        <td><input type="number" class="instrumento madeiras" value="0"></td>
        <td class="total">TOTAL GERAL</td>
        <td id="totalGeral" class="total-c">0</td>
      </tr>
      <tr>
        <td>TROMPETES</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>TROMPAS</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>TROMBONES</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
        <td class="total">NAIPES</td>
        <td class="total-c"><b>%</b></td>
      </tr>
      <tr>
        <td>TROMBONITOS</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
        <td>CORDAS</td>
        <td>
          <div class="porcentagem-wrapper">
            <input type="number" id="percCordas" class="porcentagem" value="0" readonly>
            <span class="percent-simbolo">%</span>
          </div>
        </td>
      </tr>
      <tr>
        <td>EUFONIOS</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
        <td>MADEIRAS</td>
        <td>
          <div class="porcentagem-wrapper">
            <input type="number" id="percMadeiras" class="porcentagem" value="0" readonly>
            <span class="percent-simbolo">%</span>
          </div>
        </td>
      </tr>
      <tr>
        <td>TUBAS</td>
        <td><input type="number" class="instrumento metais" value="0"></td>
        <td>METAIS</td>
        <td>
          <div class="porcentagem-wrapper">
            <input type="number" id="percMetais" class="porcentagem" value="0" readonly>
            <span class="percent-simbolo">%</span>
          </div>
        </td>
      </tr>

      <tfoot>
        <tr>
          <td colspan="4" style="background-color: #f1f1f1; padding: 8px;">
            <b>HINOS ENSAIADOS:</b><br>
            <textarea id="hinos" placeholder="Digite os n√∫meros separados por v√≠rgula..."></textarea>
            <p id="resumoHinos"><i>Foram ensaiados 0 hinos.</i></p>
          </td>
        </tr>
      </tfoot>

    </table>

    <button onclick="window.print()">üñ®Ô∏è Imprimir / Salvar PDF</button>
  </div>

  <script>
    function atualizarTotais() {
      let instrumentos = document.querySelectorAll('.instrumento');
      let servicos = document.querySelectorAll('.servico');

      let totalCordas = 0, totalMadeiras = 0, totalMetais = 0;
      let totalMusicos = 0;

      instrumentos.forEach(i => {
        let val = Number(i.value);
        totalMusicos += val;
        if (i.classList.contains("cordas")) totalCordas += val;
        if (i.classList.contains("madeiras")) totalMadeiras += val;
        if (i.classList.contains("metais")) totalMetais += val;
      });

      // soma cornet e fluegehorn tamb√©m nos metais
      servicos.forEach(i => {
        let nome = i.parentElement.previousElementSibling.innerText.trim().toUpperCase();
        let val = Number(i.value);
        if (nome === "CORNET" || nome === "FLUEGEHORN") {
          totalMetais += val;
          totalMusicos += val;
        }
      });

      document.getElementById('totalMusicos').innerText = totalMusicos;

      // servi√ßos extras
      let totalServicos = 0;
      servicos.forEach(i => {
        let nome = i.parentElement.previousElementSibling.innerText.trim().toUpperCase();
        if (nome !== "CORNET" && nome !== "FLUEGEHORN") {
          totalServicos += Number(i.value);
        }
      });

      document.getElementById('totalGeral').innerText = totalMusicos + totalServicos;

      // calcular % de cada naipe
      document.getElementById('percCordas').value = totalMusicos > 0 ? ((totalCordas / totalMusicos) * 100).toFixed(2) : 0;
      document.getElementById('percMadeiras').value = totalMusicos > 0 ? ((totalMadeiras / totalMusicos) * 100).toFixed(2) : 0;
      document.getElementById('percMetais').value = totalMusicos > 0 ? ((totalMetais / totalMusicos) * 100).toFixed(2) : 0;
    }

    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', atualizarTotais);
    });

    //Aqui esta o Script para contar os hinos (caso queira alterar algo √© s√≥ mexer aqui)

    const hinosInput = document.getElementById("hinos");
    const resumoHinos = document.getElementById("resumoHinos");

    function atualizarResumoHinos() {
      let texto = hinosInput.value;
      // separa por v√≠rgulas ou espa√ßos e remove vazios
      let numeros = texto.split(/[\s,]+/).filter(n => n.trim() !== "");
      let total = numeros.length;

      resumoHinos.innerHTML = `<b>Foram ensaiados o total de ${total} Hino${total !== 1 ? 's' : ''}.</b>`;
    }

    hinosInput.addEventListener("input", atualizarResumoHinos);
  </script>
</body>

</html>
